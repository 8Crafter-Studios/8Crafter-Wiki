import{_ as s,r as l,c as r,a,b as e,d as n,o}from"./404.md.a0a982dc.js";var i="/assets/images/knowledge/shaders/debugShader.gif";const se='{"title":"Shaders","description":"","frontmatter":{"title":"Shaders"},"headers":[{"level":2,"title":"Overview","slug":"overview"},{"level":2,"title":"Materials","slug":"materials"},{"level":3,"title":"Common material definition fields","slug":"common-material-definition-fields"},{"level":2,"title":"Troubleshooting","slug":"troubleshooting"},{"level":3,"title":"Shader doesn\u2019t change","slug":"shader-doesn\u2019t-change"},{"level":3,"title":"Compilation error","slug":"compilation-error"},{"level":3,"title":"Couldn\u2019t find constant buffer named: $Globals","slug":"couldn\u2019t-find-constant-buffer-named-globals"},{"level":2,"title":"Tips and tricks","slug":"tips-and-tricks"},{"level":3,"title":"Passing variables to the shader","slug":"passing-variables-to-the-shader"},{"level":3,"title":"Using time in shader","slug":"using-time-in-shader"},{"level":3,"title":"Camera direction towards the entity","slug":"camera-direction-towards-the-entity"},{"level":3,"title":"Debugging values","slug":"debugging-values"}],"relativePath":"concepts/shaders.md","lastUpdated":1644788543542}',d={},c=e("div",{class:"warning custom-block"},[e("p",{class:"custom-block-title"},"WARNING"),e("p",null,[n("The shaders on this page are incompatible with "),e("a",{href:"https://help.minecraft.net/hc/en-us/articles/360052771272-About-the-1-16-200-Update-for-Windows-10-",target:"_blank",rel:"noopener noreferrer"},"Render Dragon"),n(". That means that they will not work on Windows 10 or Console devices!")])],-1),u=e("h2",{id:"overview",tabindex:"-1"},[n("Overview "),e("a",{class:"header-anchor",href:"#overview","aria-hidden":"true"},"#")],-1),p=e("p",null,[n("Shaders are divided into 2 folders: "),e("code",null,"glsl"),n(" and "),e("code",null,"hlsl"),n(". For shaders to work on every device, you need to code shaders in both languages. For testing on Windows, "),e("code",null,"hlsl"),n(" is enough. When rewriting shaders from one language to another, there are few things to change, like HLSL "),e("code",null,"float3"),n(" is "),e("code",null,"vec3"),n(" in GLSL. Mapping between those languages can be found "),e("a",{href:"https://anteru.net/blog/2016/mapping-between-HLSL-and-GLSL/",target:"_blank",rel:"noopener noreferrer"},"here")],-1),h=e("h2",{id:"materials",tabindex:"-1"},[n("Materials "),e("a",{class:"header-anchor",href:"#materials","aria-hidden":"true"},"#")],-1),m=e("p",null,[n("Vertex, fragments, and sometimes geometry shaders are combined with some options as materials and are required for custom shaders. To create new material, you need to create a file, which matches the name of the .material file in the vanilla resource pack. For example: "),e("code",null,"materials/particles.material"),n(". Materials support inheritance by adding parent material after a colon. For example: "),e("code",null,"entity_alpha:entity_base")],-1),b=e("h3",{id:"common-material-definition-fields",tabindex:"-1"},[n("Common material definition fields "),e("a",{class:"header-anchor",href:"#common-material-definition-fields","aria-hidden":"true"},"#")],-1),g=e("table",null,[e("thead",null,[e("tr",null,[e("th",null,[e("strong",null,"Field name")]),e("th",null,[e("strong",null,"Description")]),e("th",null,[e("strong",null,"Example value")]),e("th",null,[e("strong",null,"Notes")])])]),e("tbody",null,[e("tr",null,[e("td",null,[e("code",null,"vertexShader")]),e("td",null,"Path to the shader relative to hlsl/glsl folder"),e("td"),e("td",null,[n("For HLSL shader, "),e("code",null,".hlsl"),n(" suffix is added.")])]),e("tr",null,[e("td",null,[e("code",null,"fragmentShader")]),e("td",null,"Path to the shader relative to hlsl/glsl folder"),e("td"),e("td",null,[n("For HLSL shader, "),e("code",null,".hlsl"),n(" suffix is added.")])]),e("tr",null,[e("td",null,[e("code",null,"vertexFields")]),e("td",null,"An array of fields passed to vertex shader"),e("td"),e("td",null,"It's better to copy this field from vanilla material.")]),e("tr",null,[e("td",null,[e("code",null,"variants")]),e("td",null,"An array of objects, which define variants of the material"),e("td"),e("td",null,"It's better to copy this field from vanilla material.")]),e("tr",null,[e("td",null,[e("code",null,"+defines")]),e("td",null,[n("An array of "),e("code",null,"#define"),n(" directives to add to the shader source")]),e("td"),e("td",null,"Useful for reusing shader, but changing some minor setting.")]),e("tr",null,[e("td",null,[e("code",null,"+states")]),e("td",null,"An array of states to enable"),e("td",null,[e("code",null,'["Blending", "DisableAlphaWrite", "DisableDepthWrite"]')]),e("td",null,[n("For OpenGL implementation, this is equivalent to "),e("a",{href:"https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glEnable.xml",target:"_blank",rel:"noopener noreferrer"},"glEnable"),n(" call.")])]),e("tr",null,[e("td",null,[e("code",null,"-defines")]),e("td",null,[n("An array of "),e("code",null,"#defines"),n(" directives to remove from inherited "),e("code",null,"+defines")]),e("td"),e("td")]),e("tr",null,[e("td",null,[e("code",null,"+samplerStates")]),e("td",null,"An array of objects, defining how texture at certain index is treated"),e("td",null,[e("code",null,'{ "samplerIndex": 0, "textureFilter": "Point" }')]),e("td",null,[e("code",null,"textureFilter"),n(" specifies how to sample the texture and "),e("code",null,"textureWrap"),n(" specifies the behavior, when accessing outside of the texture dimensions.")])]),e("tr",null,[e("td",null,[e("code",null,"msaaSupport")]),e("td",null,"Multisample anti-aliasing support"),e("td",null,[e("code",null,"Both")]),e("td")]),e("tr",null,[e("td",null,[e("code",null,"blendSrc")]),e("td",null,"Specifies how the color source blending factors are computed"),e("td",null,[e("code",null,"One")]),e("td",null,[n("For OpenGL implementation, this is equivalent to "),e("a",{href:"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBlendFunc.xhtml",target:"_blank",rel:"noopener noreferrer"},"glBlendFunc"),n(" call.")])]),e("tr",null,[e("td",null,[e("code",null,"blendDst")]),e("td",null,"Specifies how the color destination blending factors are computed"),e("td",null,[e("code",null,"One")]),e("td",null,[n("For OpenGL implementation, this is equivalent to "),e("a",{href:"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBlendFunc.xhtml",target:"_blank",rel:"noopener noreferrer"},"glBlendFunc"),n(" call.")])])])],-1),f=e("p",null,"Example:",-1),_=e("div",{class:"language-json line-numbers-mode"},[e("pre",null,[e("code",null,[e("span",{class:"token punctuation"},"{"),n(`
	`),e("span",{class:"token property"},'"materials"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token punctuation"},"{"),n(`
		`),e("span",{class:"token property"},'"version"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"1.0.0"'),e("span",{class:"token punctuation"},","),n(`
		`),e("span",{class:"token property"},'"particle_debug"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token punctuation"},"{"),n(`
			`),e("span",{class:"token property"},'"vertexShader"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"shaders/particle_generic.vertex"'),e("span",{class:"token punctuation"},","),n(`
			`),e("span",{class:"token property"},'"fragmentShader"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"shaders/particle_debug.fragment"'),e("span",{class:"token punctuation"},","),n(`

			`),e("span",{class:"token property"},'"vertexFields"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token punctuation"},"["),n(`
				`),e("span",{class:"token punctuation"},"{"),n(),e("span",{class:"token property"},'"field"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"Position"'),n(),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),n(`
				`),e("span",{class:"token punctuation"},"{"),n(),e("span",{class:"token property"},'"field"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"Color"'),n(),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),n(`
				`),e("span",{class:"token punctuation"},"{"),n(),e("span",{class:"token property"},'"field"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"UV0"'),n(),e("span",{class:"token punctuation"},"}"),n(`
			`),e("span",{class:"token punctuation"},"]"),e("span",{class:"token punctuation"},","),n(`

			`),e("span",{class:"token property"},'"+samplerStates"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token punctuation"},"["),n(`
				`),e("span",{class:"token punctuation"},"{"),n(`
					`),e("span",{class:"token property"},'"samplerIndex"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),n(`
					`),e("span",{class:"token property"},'"textureFilter"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"Point"'),n(`
				`),e("span",{class:"token punctuation"},"}"),n(`
			`),e("span",{class:"token punctuation"},"]"),e("span",{class:"token punctuation"},","),n(`

			`),e("span",{class:"token property"},'"msaaSupport"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token string"},'"Both"'),n(`
		`),e("span",{class:"token punctuation"},"}"),n(`
	`),e("span",{class:"token punctuation"},"}"),n(`
`),e("span",{class:"token punctuation"},"}"),n(`
`)])]),e("div",{class:"line-numbers-wrapper"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br"),e("span",{class:"line-number"},"7"),e("br"),e("span",{class:"line-number"},"8"),e("br"),e("span",{class:"line-number"},"9"),e("br"),e("span",{class:"line-number"},"10"),e("br"),e("span",{class:"line-number"},"11"),e("br"),e("span",{class:"line-number"},"12"),e("br"),e("span",{class:"line-number"},"13"),e("br"),e("span",{class:"line-number"},"14"),e("br"),e("span",{class:"line-number"},"15"),e("br"),e("span",{class:"line-number"},"16"),e("br"),e("span",{class:"line-number"},"17"),e("br"),e("span",{class:"line-number"},"18"),e("br"),e("span",{class:"line-number"},"19"),e("br"),e("span",{class:"line-number"},"20"),e("br"),e("span",{class:"line-number"},"21"),e("br"),e("span",{class:"line-number"},"22"),e("br"),e("span",{class:"line-number"},"23"),e("br"),e("span",{class:"line-number"},"24"),e("br")])],-1),k=e("p",null,[n("For all the details about material files and possible field values, check "),e("a",{href:"https://github.com/stirante/bedrock-shader-schema/blob/master/materials.schema.json",target:"_blank",rel:"noopener noreferrer"},"material file JSON schema"),n(".")],-1),v=e("h2",{id:"troubleshooting",tabindex:"-1"},[n("Troubleshooting "),e("a",{class:"header-anchor",href:"#troubleshooting","aria-hidden":"true"},"#")],-1),w=e("h3",{id:"shader-doesn\u2019t-change",tabindex:"-1"},[n("Shader doesn\u2019t change "),e("a",{class:"header-anchor",href:"#shader-doesn\u2019t-change","aria-hidden":"true"},"#")],-1),y=e("p",null,"Every time there is a change in the shader, you need to restart Minecraft to recompile the shader completely.",-1),x=e("h3",{id:"compilation-error",tabindex:"-1"},[n("Compilation error "),e("a",{class:"header-anchor",href:"#compilation-error","aria-hidden":"true"},"#")],-1),S=e("p",null,[n("When there is a shader compilation error, a line number is usually specified where the error occurred. You need to check a few lines above the one set in error because Minecraft adds "),e("code",null,"#define"),n(" directives before compilation.")],-1),F=e("h3",{id:"couldn\u2019t-find-constant-buffer-named-globals",tabindex:"-1"},[n("Couldn\u2019t find constant buffer named: $Globals "),e("a",{class:"header-anchor",href:"#couldn\u2019t-find-constant-buffer-named-globals","aria-hidden":"true"},"#")],-1),I=e("p",null,[n("I couldn\u2019t accurately find the actual cause of this error, but it seems to be somehow connected to global variables. Removing them (initializing them in the "),e("code",null,"main"),n(" function or changing them to "),e("code",null,"#define"),n(" directives) seems to fix the problem.")],-1),L=e("h2",{id:"tips-and-tricks",tabindex:"-1"},[n("Tips and tricks "),e("a",{class:"header-anchor",href:"#tips-and-tricks","aria-hidden":"true"},"#")],-1),O=e("h3",{id:"passing-variables-to-the-shader",tabindex:"-1"},[n("Passing variables to the shader "),e("a",{class:"header-anchor",href:"#passing-variables-to-the-shader","aria-hidden":"true"},"#")],-1),P=e("p",null,[n("You can pass variables to the shader from a particle or an entity by changing entity color. Input color is clamped to "),e("code",null,"<0.0, 1.0>"),n(". To pass more significant values, you need to divide by max value (or at least some considerable number).")],-1),T=e("h3",{id:"using-time-in-shader",tabindex:"-1"},[n("Using time in shader "),e("a",{class:"header-anchor",href:"#using-time-in-shader","aria-hidden":"true"},"#")],-1),C=e("p",null,[e("code",null,"TIME"),n(" variable is a number of seconds as "),e("code",null,"float"),n(" and is global for all shaders. For time-based on particle lifetime, you need to pass this:")],-1),D=e("div",{class:"language-json line-numbers-mode"},[e("pre",null,[e("code",null,[e("span",{class:"token property"},'"minecraft:particle_appearance_tinting"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token punctuation"},"{"),n(`
    `),e("span",{class:"token property"},'"color"'),e("span",{class:"token operator"},":"),n(),e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},'"variable.particle_age/variable.particle_lifetime"'),e("span",{class:"token punctuation"},","),n(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),n(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),n(),e("span",{class:"token number"},"1"),e("span",{class:"token punctuation"},"]"),n(`
`),e("span",{class:"token punctuation"},"}"),n(`
`)])]),e("div",{class:"line-numbers-wrapper"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br")])],-1),G=e("p",null,[n("Then in the shader, use "),e("code",null,"PSInput.color.r"),n(" as time, where "),e("code",null,"0.0"),n(" is particle birth and "),e("code",null,"1.0"),n(" is particle death.")],-1),A=e("h3",{id:"camera-direction-towards-the-entity",tabindex:"-1"},[n("Camera direction towards the entity "),e("a",{class:"header-anchor",href:"#camera-direction-towards-the-entity","aria-hidden":"true"},"#")],-1),B=e("p",null,"For entity shaders, you can make the shader dependent on the camera direction towards the entity.",-1),W=e("ul",null,[e("li",null,[n("Add to "),e("code",null,"PS_Input"),n(" in vertex and fragment shader new field")])],-1),M=e("div",{class:"language-"},[e("pre",null,[e("code",null,`float3 viewDir: POSITION;
`)]),e("div",{class:"line-numbers-wrapper"},[e("span",{class:"line-number"},"1"),e("br")])],-1),N=e("ul",null,[e("li",null,"After that, add to vertex shader this line")],-1),E=e("div",{class:"language-"},[e("pre",null,[e("code",null,`PSInput.viewDir = normalize((mul(WORLD, mul(BONES[VSInput.boneId], float4(VSInput.position, 1)))).xyz);
`)]),e("div",{class:"line-numbers-wrapper"},[e("span",{class:"line-number"},"1"),e("br")])],-1),R=e("ul",null,[e("li",null,[n("In the fragment shader, use "),e("code",null,"PSInput.viewDir"),n(" to make changes depending on camera rotation")])],-1),V=e("h3",{id:"debugging-values",tabindex:"-1"},[n("Debugging values "),e("a",{class:"header-anchor",href:"#debugging-values","aria-hidden":"true"},"#")],-1),j=e("p",null,"The easiest way to debug a value is to turn it into color and render it like this.",-1),H=e("div",{class:"language-"},[e("pre",null,[e("code",null,`PSOutput.color = float4(PSInput.uv, 0., 1.);
`)]),e("div",{class:"line-numbers-wrapper"},[e("span",{class:"line-number"},"1"),e("br")])],-1),U=e("p",null,[n("This should create a red-green gradient, showing that the values of "),e("code",null,"uv"),n(" are between "),e("code",null,"<0, 0>"),n(" and "),e("code",null,"<1, 1>"),n(".")],-1),$=e("p",null,[n("You can use the debug shader I wrote "),e("a",{href:"http://mew.cx/drawtext/drawtext",target:"_blank",rel:"noopener noreferrer"},"based on this shader"),n(". Right now, this shader will display values of the color passed to the shader. To display another value, change line 70 in hlsl shader to")],-1),q=e("div",{class:"language-"},[e("pre",null,[e("code",null,`int ascii = getFloatCharacter( cellIndex, <float4 vector here> );
`)]),e("div",{class:"line-numbers-wrapper"},[e("span",{class:"line-number"},"1"),e("br")])],-1),z=e("p",null,"GLSL version of debugging shader may crash Minecraft, use only for debugging.",-1),Y=e("p",null,[e("a",{href:"http://files.stirante.com/debugShader.zip",target:"_blank",rel:"noopener noreferrer"},"Download debug shader")],-1),J=e("p",null,[e("img",{src:i,alt:""})],-1);function K(Q,X,Z,ee,ne,te){const t=l("CodeHeader");return o(),r("div",null,[c,u,p,h,m,b,g,f,a(t),_,k,v,w,y,x,S,F,I,L,O,P,T,C,a(t),D,G,A,B,W,a(t),M,N,a(t),E,R,V,j,a(t),H,U,$,a(t),q,z,Y,J])}var le=s(d,[["render",K]]);export{se as __pageData,le as default};
